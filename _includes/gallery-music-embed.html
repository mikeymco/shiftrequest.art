{% assign gallery_config = site.data.gallery.galleries[page.gallery] %}

{% if gallery_config.spotify_playlist or gallery_config.spotify_track or gallery_config.soundcloud_track or gallery_config.soundcloud_playlist %}
<div class="gallery-music-embed">
	<button class="gallery-music-embed__close" aria-label="Close music player">Ã—</button>

	{% if gallery_config.spotify_playlist %}
	<div class="gallery-music-embed__spotify-container">
		<iframe class="gallery-music-embed__spotify-playlist" style="border-radius:12px"
			src="https://open.spotify.com/embed/playlist/{{ gallery_config.spotify_playlist }}?utm_source=generator&theme=0"
			frameBorder="0"
			allowfullscreen=""
			allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
			loading="lazy"
			title="Gallery Soundtrack">
		</iframe>
	</div>
	{% elsif gallery_config.spotify_track %}
	<div class="gallery-music-embed__spotify-container">
		<iframe class="gallery-music-embed__spotify-track" style="border-radius:12px"
			src="https://open.spotify.com/embed/track/{{ gallery_config.spotify_track }}?utm_source=generator&theme=0"
			frameBorder="0"
			allowfullscreen=""
			allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
			loading="lazy"
			title="Gallery Soundtrack">
		</iframe>
	</div>
	{% elsif gallery_config.soundcloud_track %}
	<div class="gallery-music-embed__soundcloud-container">
		{% comment %} Handle both numeric IDs and permalink formats {% endcomment %}
		{% if gallery_config.soundcloud_track contains "/" %}
			{% assign sc_url = "https%3A//soundcloud.com/" | append: gallery_config.soundcloud_track %}
		{% else %}
			{% assign sc_url = "https%3A//api.soundcloud.com/tracks/" | append: gallery_config.soundcloud_track %}
		{% endif %}
		<iframe class="gallery-music-embed__soundcloud-track"
			src="https://w.soundcloud.com/player/?url={{ sc_url }}&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"
			frameBorder="0"
			allow="autoplay"
			loading="lazy"
			title="Gallery Soundtrack">
		</iframe>
	</div>
	{% elsif gallery_config.soundcloud_playlist %}
	<div class="gallery-music-embed__soundcloud-container">
		<iframe class="gallery-music-embed__soundcloud-playlist"
			src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/{{ gallery_config.soundcloud_playlist }}&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true"
			frameBorder="0"
			allow="autoplay"
			loading="lazy"
			title="Gallery Soundtrack">
		</iframe>
	</div>
	{% endif %}
</div>
{% endif %}

<!-- Music Player Management -->
<script src="{{ '/assets/js/gallery-music-embed.js' | relative_url }}"></script>
